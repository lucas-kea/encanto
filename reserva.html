<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprovante de Reserva - Encanto Festas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Quicksand', sans-serif; 
            background-color: #F1F5F9; 
            color: #1E293B; 
            padding: 20px 10px;
        }
        .receipt-container {
            max-width: 480px;
            margin: 0 auto;
            background: white;
            position: relative;
            box-shadow: 0 15px 35px rgba(0, 51, 153, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        /* Efeito de recorte serrilhado nas pontas */
        .serrilhado-topo {
            height: 10px;
            background-image: radial-gradient(circle, #F1F5F9 5px, transparent 5px);
            background-size: 15px 15px;
            background-position: center top;
            width: 100%;
            position: absolute;
            top: -5px;
        }
        .serrilhado-fundo {
            height: 10px;
            background-image: radial-gradient(circle, #F1F5F9 5px, transparent 5px);
            background-size: 15px 15px;
            background-position: center bottom;
            width: 100%;
            position: absolute;
            bottom: -5px;
        }

        .dashed-line {
            border-top: 2px dashed #F1F5F9;
            margin: 18px 0;
        }

        .section-label {
            font-size: 10px;
            font-weight: 800;
            color: #94A3B8;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 2px;
        }

        .important-data {
            font-weight: 700;
            color: #1E293B;
            text-transform: uppercase;
            font-size: 14px;
            line-height: 1.3;
        }

        .highlight-blue {
            color: #003399;
        }

        .status-badge {
            background-color: #DCFCE7;
            color: #15803D;
            padding: 2px 10px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: 900;
            text-transform: uppercase;
            display: inline-flex;
            align-items: center;
            gap: 3px;
        }

        .btn-print {
            background-color: #003399;
            color: white;
            font-weight: 700;
            padding: 14px;
            width: 100%;
            border-radius: 12px;
            margin-top: 20px;
            text-transform: uppercase;
            box-shadow: 0 4px 12px rgba(0, 51, 153, 0.2);
        }

        @media print {
            .no-print { display: none; }
            body { background: white; padding: 0; }
            .receipt-container { box-shadow: none; max-width: 100%; border: 1px solid #EEE; }
        }
    </style>
</head>
<body>

    <div class="receipt-container" id="comprovante">
        <div class="serrilhado-topo"></div>
        
        <div class="p-8">
            <!-- Cabeçalho Institucional -->
            <div class="text-center mb-6">
                <p class="text-[9px] font-bold text-slate-400 mb-2" id="currentDateTime">XXXX, XX:XX</p>
                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Reserva - Encanto Festas</p>
                <h1 class="text-3xl font-black text-[#003399] tracking-tighter leading-none mt-1">ENCANTOFESTAS</h1>
                <p class="text-[9px] font-bold text-slate-400 mt-2 uppercase">LOCAÇÃO DE BRINQUEDOS</p>
                <p class="text-[8px] font-bold text-slate-400 uppercase mt-1">Rua Prefeito José Schmidt, 281 - SFS/SC</p>
                <p class="text-[8px] font-bold text-slate-400 uppercase">CNPJ: 57.545.647/0001-16 | encantofestas.sfs@gmail.com</p>
            </div>

            <div class="dashed-line"></div>

            <!-- Titulo do Documento e Status -->
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-base font-black text-slate-800 uppercase">Comprovante de Reserva</h2>
                    <p class="text-xs font-bold highlight-blue" id="reservaID">#EF-XXXX</p>
                </div>
                <div class="status-badge">
                    <i class="fas fa-check"></i> Confirmado
                </div>
            </div>

            <!-- Dados do Contratante -->
            <div class="mb-5">
                <p class="section-label">CONTRATANTE</p>
                <p class="important-data text-lg" id="reservaNome">XXXX</p>
                <p class="text-xs font-bold highlight-blue" id="reservaZap">(XX) XXXXX-XXXX</p>
            </div>

            <!-- Endereço de Montagem -->
            <div class="mb-5">
                <p class="section-label">ENDEREÇO DE MONTAGEM</p>
                <p class="important-data" id="reservaRua">RUA XXXX, XXXX</p>
                <p class="important-data text-xs text-slate-500" id="reservaBairro">BAIRRO XXXX - SÃO FRANCISCO DO SUL</p>
            </div>

            <!-- Data e Horários Focados -->
            <div class="grid grid-cols-2 gap-4 mb-5">
                <div class="bg-slate-50 p-4 rounded-xl border border-slate-100">
                    <p class="section-label">DATA DA FESTA</p>
                    <p class="text-lg font-black highlight-blue" id="reservaData">XX/XX/XXXX</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-xl border border-slate-100">
                    <p class="section-label">PREVISÃO ENTREGA</p>
                    <p class="text-xs font-black text-slate-700" id="reservaPrevisao">08:00 às 09:30</p>
                </div>
            </div>

            <div class="grid grid-cols-1 mb-5">
                <div class="bg-slate-50 p-4 rounded-xl border border-slate-100">
                    <p class="section-label">RETIRADA MÍNIMA</p>
                    <p class="text-xs font-black text-slate-700" id="reservaRetirada">20:00 Horas</p>
                </div>
            </div>

            <div class="dashed-line"></div>

            <!-- Itens da Reserva -->
            <div class="mb-6">
                <p class="section-label mb-3">ITENS DA RESERVA</p>
                <div id="reservaItens" class="space-y-3">
                    <div class="flex justify-between items-center">
                        <p class="important-data text-xs">1x Pula-Pula Médio (3 Metros)</p>
                        <span class="text-[8px] font-black text-green-600 uppercase">CONFIRMADO</span>
                    </div>
                </div>
            </div>

            <!-- Outros Detalhes -->
            <div class="grid grid-cols-1 gap-4 mb-6">
                <div>
                    <p class="section-label">SEGURO ADICIONAL</p>
                    <p class="important-data text-xs" id="reservaSeguro">NÃO CONTRATADO</p>
                </div>
                <div>
                    <p class="section-label">SALDO NA MONTAGEM (PIX ou Dinheiro)</p>
                    <p class="text-2xl font-black highlight-blue" id="reservaTotal">R$ 0,00</p>
                </div>
            </div>

            <!-- Notas Rápidas -->
            <div class="bg-slate-50 p-4 rounded-xl border border-slate-100 space-y-1 mb-6">
                <p class="text-[9px] font-bold text-slate-500 flex gap-2">
                    <span class="text-blue-500">•</span>
                    <span>CHÃO RETO: <span class="text-slate-700">Terreno plano. Não montamos em rampas.</span></span>
                </p>
                <p class="text-[9px] font-bold text-slate-500 flex gap-2">
                    <span class="text-blue-500">•</span>
                    <span>IDADE: <span class="text-slate-700">Brinquedos para crianças até 14 anos.</span></span>
                </p>
                <p class="text-[9px] font-bold text-slate-500 flex gap-2">
                    <span class="text-blue-500">•</span>
                    <span>MONITOR: <span class="text-slate-700" id="reservaMonitor">Não incluso. Supervisão é do contratante.</span></span>
                </p>
                <p class="text-[9px] font-bold text-slate-500 flex gap-2">
                    <span class="text-blue-500">•</span>
                    <span>CANCELAMENTO: <span class="text-slate-700">Menos de 6 dias perde o sinal.</span></span>
                </p>
            </div>

            <div class="dashed-line"></div>

            <!-- Normas de Segurança -->
            <div class="mb-4">
                <p class="section-label text-center mb-3">Normas de Segurança</p>
                <div class="grid grid-cols-1 gap-2">
                    <p class="text-[8px] font-bold text-slate-400 uppercase leading-tight">• VIA PÚBLICA: Proibida montagem sem autorização formal.</p>
                    <p class="text-[8px] font-bold text-slate-400 uppercase leading-tight">• ENERGIA: Cliente deve garantir tomada funcional no local.</p>
                    <p class="text-[8px] font-bold text-slate-400 uppercase leading-tight">• CLIMA: Ventos fortes ou chuva suspendem o uso.</p>
                    <p class="text-[8px] font-bold text-slate-400 uppercase leading-tight">• REGRAS: Sem calçados, comidas ou pets no brinquedo.</p>
                </div>
            </div>

            <!-- Rodapé Técnico -->
            <div class="text-center mt-8 border-t border-slate-50 pt-4">
                <p class="text-[7px] font-bold text-slate-300 uppercase tracking-widest">ENCANTO FESTAS - SFS-SC - GERADO EM <span id="generationDate">XX/XX/XXXX</span></p>
            </div>
        </div>

        <div class="serrilhado-fundo"></div>
    </div>

    <!-- Controles -->
    <div class="max-w-[480px] mx-auto p-4 no-print">
        <button onclick="window.print()" class="btn-print">
            <i class="fas fa-print mr-2"></i> Imprimir Comprovante
        </button>
        <button onclick="window.location.href='index.html'" class="w-full text-slate-400 text-[10px] font-bold uppercase mt-6 text-center block tracking-widest hover:text-[#003399] transition-colors">
            <i class="fas fa-arrow-left mr-1"></i> Nova Reserva
        </button>
    </div>

    <script>
        function formatarDataHora() {
            const agora = new Date();
            const data = agora.toLocaleDateString('pt-BR');
            const hora = agora.toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
            return `${data}, ${hora}`;
        }

        function carregarDadosReserva() {
            const dados = JSON.parse(localStorage.getItem('encanto_reservas') || '[]');
            if (dados.length === 0) return;

            const reserva = dados[dados.length - 1];

            // Timestamps
            const now = formatarDataHora();
            document.getElementById('currentDateTime').innerText = now;
            document.getElementById('generationDate').innerText = now;
            
            // Dados Identificação
            document.getElementById('reservaNome').innerText = reserva.nome || 'XXXX';
            document.getElementById('reservaID').innerText = '#EF-' + (reserva.id || 'XXXX');
            document.getElementById('reservaZap').innerText = reserva.whatsapp || '(XX) XXXXX-XXXX';
            
            // Endereço
            document.getElementById('reservaRua').innerText = (reserva.rua || 'XXXX') + ', ' + (reserva.num || 'XXXX');
            document.getElementById('reservaBairro').innerText = 'BAIRRO ' + (reserva.bairro || 'XXXX') + ' - SÃO FRANCISCO DO SUL';
            
            // Logística
            document.getElementById('reservaData').innerText = reserva.evento || 'XX/XX/XXXX';
            
            // Cálculo Previsão Entrega (1.5h antes do início)
            if (reserva.inicio) {
                const [h, m] = reserva.inicio.split(':');
                const dataBase = new Date();
                dataBase.setHours(parseInt(h), parseInt(m), 0);
                
                const inicioEntrega = new Date(dataBase.getTime() - (90 * 60000));
                const fimEntrega = dataBase;
                
                const fH = (d) => d.getHours().toString().padStart(2, '0') + ':' + d.getMinutes().toString().padStart(2, '0');
                document.getElementById('reservaPrevisao').innerText = `${fH(inicioEntrega)} às ${fH(fimEntrega)}`;
            }

            // Itens da Reserva
            const itensContainer = document.getElementById('reservaItens');
            if (reserva.itens) {
                itensContainer.innerHTML = reserva.itens.split('\n').map(item => {
                    return `
                        <div class="flex justify-between items-center">
                            <p class="important-data text-xs">${item}</p>
                            <span class="text-[8px] font-black text-green-600 uppercase">CONFIRMADO</span>
                        </div>
                    `;
                }).join('');
            }

            // Detalhes Técnicos
            document.getElementById('reservaSeguro').innerText = reserva.seguro === "Sim" ? "CONTRATADO" : "NÃO CONTRATADO";
            document.getElementById('reservaMonitor').innerText = reserva.monitores !== "Não" ? `Incluso (${reserva.monitores}).` : "Não incluso. Supervisão é do contratante.";
            document.getElementById('reservaRetirada').innerText = (reserva.termino === "Dia Seg." ? "PRÓXIMO DIA" : reserva.termino) + " HORAS";
            document.getElementById('reservaTotal').innerText = reserva.total || 'R$ 0,00';
        }

        window.onload = carregarDadosReserva;
    </script>
</body>
</html>
